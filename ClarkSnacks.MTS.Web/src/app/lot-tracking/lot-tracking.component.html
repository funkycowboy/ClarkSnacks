<p-toast position="top-right"></p-toast>
<h2>Lot Tracking Form</h2>

<form [formGroup]="lotTrackingForm" (ngSubmit)="onSubmit(lotTrackingForm.value)">

  <div class="ui-g" style="background-color: #ececec; border-radius:5px; padding: 15px;">
    <!--<div class="ui-g-12">
      <label for="Supplier">Shipment Supplier: </label>
    </div>
    <div class="ui-g-12">
      <p-dropdown filter="true" name="Supplier" (onChange)="vendorChange($event)" [options]="supplierOptions"></p-dropdown>
    </div>-->
    <div class="ui-g-12">
      <label for="Supplier">Production Line: </label> <span style="color: blue">Line 1</span>
    </div>
    <div class="ui-g-12">
      <label for="Supplier">Material Category: </label>
      <span class="fa fa-search" style="margin-left:15px;font-size: 24px; color: blue" (click)="showLabelInfo()" title="Where can I find the Lot Number?"></span>
    </div>
    <div class="ui-g-12 ui-fluid">
      <p-dropdown formControlName="materialCategory" filter="true" name="MaterialCategory" (onChange)="materialCategoryChange($event)" [options]="materialCategoryOptions"></p-dropdown>
    </div>
    <div class="ui-g-12 ui-inputgroup ui-g ui-fluid" style="padding:0" *ngIf="selectedMaterialCategory">
      <div class="ui-g-12">
        <label for="Items">Item: </label>
      </div>
      <div class="ui-g-12 ui-fluid">
        <p-dropdown formControlName="item" filter="true" (onChange)="itemChange($event)" [options]="itemOptions"></p-dropdown>
      </div>
    </div>
    <div class="ui-g-12 ui-inputgroup ui-g" style="padding:0" *ngIf="selectedItem">
      <div class="ui-g-12">
        <label for="Items">Select or enter a new Lot Number:</label>
      </div>
      <div class="ui-g-12 ui-fluid">
        <p-dropdown formControlName="lotNumber" filter="true" [options]="lotOptions" (onChange)="lotNumberChange($event)"></p-dropdown>
      </div>
      <div class="ui-g-12" *ngIf="lotNumberManuallyEntered" style="padding:0">
        <div class="ui-g-12">
          <label for="Items">Confirm Lot Number:</label>
        </div>
        <div class="ui-g-12 ui-fluid">
          <input formControlName="lotNumberConfirm" pInputText type="text" (blur)="validateLotNumber($event)" />
        </div>
      </div>
    </div>
    <div class="ui-g-12" style="text-align:right">
      <button class="ui-button-rounded ui-button-success" type="submit" pButton icon="fa fa-arrow-circle-right" label="Log Lot" [disabled]="!lotTrackingForm.valid"></button>
    </div>
  </div>

</form>

<p-dialog header="Supplier Label Information" [(visible)]="displayDialog" [focusOnShow]="true" [responsive]="true" showEffect="fade" [modal]="true">
<div class="ui-g ui-fluid">
  <div class="ui-g-12">
    <img src="assets/supplier-labels/belmark.jpg" />
  </div>
</div>

<p-footer>
  <button type="button" pButton icon="fa fa-close" label="Close" (click)="closeLabelInfoDialog()"></button>&nbsp;
</p-footer>
</p-dialog>

<p-sidebar [(visible)]="showLotLog" position="bottom" modal="true" styleClass="ui-sidebar-md">

  <h3 style="margin-top: 0">Lot Log</h3>
  <p-table #dtLotLog [value]="lotLogs" [columns]="cols" dataKey="id" [responsive]="true" [paginator]="true" [rows]="4" [showCurrentPageReport]="false"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries">
    <ng-template pTemplate="header" let-columns>
      <th *ngFor="let col of columns" [pSortableColumn]="col.field">
        {{col.header}}
        <p-sortIcon [field]="col.field" ariaLabel="Activate to sort" ariaLabelDesc="Activate to sort in descending order" ariaLabelAsc="Activate to sort in ascending order"></p-sortIcon>
      </th>
    </ng-template>
    <ng-template pTemplate="body" let-rowData let-rowIndexLot="rowIndex">
      <tr style="background-color: #ececec;">
        <td style="text-align:center">
          {{rowData.dateProcessed}}
        </td>
        <td style="text-align:center">
          {{rowData.materialCategoryName}}
        </td>
        <td style="text-align:center">
          {{rowData.lotNumber}}
        </td>
        <td style="text-align:center">
          {{rowData.itemDescription}}
        </td>
      </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage" let-columns>
      <tr>
        <td colspan="4">
          No lots have been logged today.
        </td>
      </tr>
    </ng-template>
  </p-table>

</p-sidebar>

<p-toast position="top-right"></p-toast>
<!--<h3>Lot Tracking Form</h3>-->

<form [formGroup]="lotTrackingForm" (ngSubmit)="onSubmit(lotTrackingForm.value)">

  <div class="ui-g" style="background-color: #ececec; border-radius:5px; padding: 15px;">
    <!--<div class="ui-g-12">
      <label for="Supplier">Shipment Supplier: </label>
    </div>
    <div class="ui-g-12">
      <p-dropdown filter="true" name="Supplier" (onChange)="vendorChange($event)" [options]="supplierOptions"></p-dropdown>
    </div>-->

    <div class="ui-g-12" style="padding-top:0px">
      <div class="ui-g-2" style="padding-top:0px">
        <label for="Operator">Operator: </label>
      </div>
      <div class="ui-g-10" style="padding-top:0px">

        <p-dropdown formControlName="operator" filter="true" name="Operator" (onChange)="operatorChange($event)" [options]="operatorOptions"></p-dropdown>&nbsp;

        <label for="Supplier" style="font-weight: normal">Line: </label> <span style="color: blue">{{productionLine}}</span>
      </div>
    </div>

    <div class="ui-g-12">
      <div class="ui-g-2">
        <label for="Supplier">Material Category: </label>
      </div>
      <div class="ui-g-10 ui-fluid">
        <p-dropdown formControlName="materialCategory" filter="true" name="MaterialCategory" (onChange)="materialCategoryChange($event)" [options]="materialCategoryOptions"></p-dropdown>
      </div>
    </div>
    <div class="ui-g-12" *ngIf="selectedMaterialCategory">
      <div class="ui-g-2">
        <label for="Items">Item: </label>
        <span class="fa fa-search" style="margin-left:15px;font-size: 20px; color: #007ad9" (click)="showLabelInfo()" title="View Supplier Labels"></span>
      </div>
      <div class="ui-g-10 ui-fluid">
        <p-dropdown formControlName="item" filter="true" (onChange)="itemChange($event)" [options]="itemOptions"></p-dropdown>
      </div>
    </div>
    <div class="ui-g-12" *ngIf="selectedItem">
      <div class="ui-g-2">
        <label for="Items">Lot Number:</label>
      </div>
      <div class="ui-g-10 ui-fluid">
        <p-dropdown formControlName="lotNumber" filter="true" [options]="lotOptions" [editable]="true" (onChange)="lotNumberChange($event)"></p-dropdown>
      </div>
    </div>
    <div class="ui-g-12" *ngIf="selectedLotNumber">
      <div class="ui-g-2">
        <label for="lastCaseOnPalette">Last case on the pallette?:</label>
      </div>
      <div class="ui-g-10">
        <p-inputSwitch formControlName="lastCaseOnPalette" [(ngModel)]="lastCaseOnPaletteChecked">></p-inputSwitch>
      </div>
    </div>
    <div class="ui-g-12" style="text-align:right">
      <button class="ui-button-rounded" type="submit" pButton icon="fa fa-arrow-circle-right" label="Log Lot"
              [ngClass]="{'ui-button-success':lotTrackingForm.valid,'ui-button-secondary':!lotTrackingForm.valid}" [disabled]="!lotTrackingForm.valid"></button>
    </div>
  </div>

  <p-dialog header="Supplier Label Information" [(visible)]="displayDialog" [focusOnShow]="true" [responsive]="true" showEffect="fade" [modal]="true">
    <div class="ui-g ui-fluid">
      <div class="ui-g-12">
        <img src="assets/supplier-labels/belmark.jpg" />
      </div>
    </div>

    <p-footer>
      <button type="button" pButton icon="fa fa-close" label="Close" (click)="closeLabelInfoDialog()"></button>&nbsp;
    </p-footer>
  </p-dialog>

  <div class="footer">
    <div style="display:inline-block; width: 50%">
      <label style="color: #fff; margin:0px 10px;">Recently Processed Lots</label>
    </div>
    <div style="display:inline-block; width: 50%; text-align:right">
      <label style="color: #fff; margin:0px 10px; font-weight: normal">Filter by: </label>
      <p-selectButton formControlName="filterLotLogBy" [options]="materialCategoryOptionsForLog" (onChange)="filterByMaterialCategory($event)"></p-selectButton>
    </div>
    <div>
      <p-table #dtLotLog [value]="lotLogs" [columns]="cols" dataKey="id" [responsive]="true" [scrollable]="true" scrollHeight="150px">
        <!--<ng-template pTemplate="caption">
          <div style="text-align: right">
            <i class="pi pi-search" style="margin:4px 4px 0 0"></i>
            <input type="text" pInputText size="50" placeholder="Global Filter" (input)="dtLotLog.filterGlobal($event.target.value, 'contains')" style="width:auto">
          </div>
        </ng-template>-->
        <ng-template pTemplate="loadingbody" let-columns="columns">
          <tr style="height:34px">
            <td *ngFor="let col of columns">
              <div class="loading-text"></div>
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="header" let-columns>
          <th *ngFor="let col of columns" [pSortableColumn]="col.field" style="text-align:center">
            {{col.header}}
            <p-sortIcon [field]="col.field" ariaLabel="Activate to sort" ariaLabelDesc="Activate to sort in descending order" ariaLabelAsc="Activate to sort in ascending order"></p-sortIcon>
          </th>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-rowIndexLot="rowIndex">
          <tr style="background-color: #ececec;">
            <td style="text-align:center">
              {{rowData.dateProcessed}}
            </td>
            <td style="text-align:center">
              {{rowData.processedByUserName}}
            </td>
            <td style="text-align:center">
              {{rowData.materialCategoryName}}
            </td>
            <td style="text-align:center;white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
              {{rowData.itemDescription}}
            </td>
            <td style="text-align:center">
              {{rowData.lotNumber}}
            </td>
            <td style="text-align:center">
              <button class="ui-button-rounded ui-button-danger" type="button" pButton icon="fa fa-trash" label="Delete" (click)="deleteProcessedLot(rowIndexLot)"></button>
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage" let-columns>
          <tr>
            <td colspan="4">
              No lots have been logged today.
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
  <!--</p-sidebar>-->
  <!-- Supplier Image-->
  <!--<p-galleria [(value)]="supplierShippingLabelImages" [responsiveOptions]="responsiveOptions" [containerStyle]="{'max-width': '640px'}" [numVisible]="5">
    <ng-template pTemplate="item" let-item>
      <img [src]="item.previewImageSrc" style="width: 100%; display: block;" />
    </ng-template>
    <ng-template pTemplate="thumbnail" let-item>
      <div class="p-grid p-nogutter p-justify-center">
        <img [src]="item.thumbnailImageSrc" style="display: block;" />
      </div>
    </ng-template>
    <ng-template pTemplate="caption" let-item>
      <h4 style="margin-bottom: .5rem; color: #ffffff;">{{item.title}}</h4>
      <p>{{item.alt}}</p>
    </ng-template>
  </p-galleria>-->
  <!-- Confirm Dialogs -->

</form>
<p-confirmDialog [style]="{width: '50vw'}"></p-confirmDialog>
